{% extends "base.html" %}

{% block title %}: {{ aisle.name }}{% endblock %}

{% block scripts %}
	<script src="/javascript/scriptaculous/scriptaculous.js" type="text/javascript" charset="utf-8"></script>

	<script src="/javascript/fn_bundle.js" type="text/javascript" charset="utf-8"></script>
{% endblock %}

{% block crumb %}<a href='/catalogue/aisle/'>Aisles</a>: <span class="active">{{ aisle.name }}</span>{% endblock %}

{% block content %}

<div class="aisle_nav">
	{% if aisle.get_previous_by_sort_name %}
		<a href="/catalogue/aisle/{{ aisle.get_previous_by_sort_name.id }}" title="{{aisle.get_previous_by_sort_name.name}}">Previous</a>	
	{% else %}
		<span>Previous</span>
	{% endif %}
	 | 
	{% if aisle.get_next_by_sort_name %}
		<a href="/catalogue/aisle/{{ aisle.get_next_by_sort_name.id }}" title="{{aisle.get_next_by_sort_name.name}}">Next</a>		
	{% else %}
		<a href="/catalogue/virtualshop/" title="Virtual shop">Next</a>
	{% endif %}
</div>


		{% if aisle.description %}
			<p class="notice">{{ aisle.description }}</p>			
		{% endif %}
		
		{% if aisle_items %}
		<ul id="product_list">
			{% for item in aisle_items %}

				{% if item.bundle %}
					<li class="has_bundle">
				{% else %}
					<li>
				{% endif %}
				
					<div class="product">{{ item.name }} {% if item.brand %}&#8212; {{ item.brand }}{% endif %}
						<span class="product_details"><span class="single_unit">{{ item.unit_number }}</span> &times; {{ item.measure_per_unit|floatformat:"-2" }}{{ item.measure_type }}{% if item.bundle %}. Pick any <strong class="total_units">{{ item.unit_number }}</strong> from the list:</span>
						
						<form method="post" accept-charset="utf-8" action="/cart/{{ item.id }}/add/" class="bundle_product_add">
						
						<ul class="bundle">
							{% for bundle_item in item.bundle.items.all|dictsort:"name" %}
								<li><input type="text" value="0" class="quantity" id="item_{{ bundle_item.id }}" name="{{ bundle_item.id }}" /> {{ bundle_item.name }}</li>
							{% endfor %}
						</ul>						
						
						</form>
						
						{% endif %} 
						{% if not item.organic %}
							<img src="/furniture/non_organic.png" width="55" height="12" alt="Not Organic" />
						{% endif %}
						{% ifequal item.price_change 'increase' %}
							<img src="/furniture/price_increase_arrow.png" width="10" height="12" alt="Price increase" />
						{% endifequal %}
						{% ifequal item.price_change 'decrease'  %}
							<img src="/furniture/price_decrease_arrow.png" width="10" height="12" alt="Price decrease" />
						{% endifequal %}
						{% if item.new_changed  %}
							<img src="/furniture/new_product_star.png" width="11" height="12" alt="New product" />
						{% endif %}</span></div>
					<form action="/cart/{{ item.id }}/add/" method="post" accept-charset="utf-8" class="product_add"><input type="text" name="quantity_{{item.id}}" value="1" id="quantity_{{item.id}}" class="quantity" /> <span class="total_product_price">Â£{{ item.price }}</span> <input type="submit" value="Add to list" class="add_button" /></form>
				</li>
			{% endfor %}
		</ul>			
		{% endif %}
		
		<div class="aisle_nav">
			{% if aisle.get_previous_by_sort_name %}
				<a href="/catalogue/aisle/{{ aisle.get_previous_by_sort_name.id }}" title="{{aisle.get_previous_by_sort_name.name}}">Previous</a>	
			{% else %}
				<span>Previous</span>
			{% endif %}
			 | 
			{% if aisle.get_next_by_sort_name %}
				<a href="/catalogue/aisle/{{ aisle.get_next_by_sort_name.id }}" title="{{aisle.get_next_by_sort_name.name}}">Next</a>		
			{% else %}
				<a href="/catalogue/virtualshop/" title="Virtual shop">Next</a>
			{% endif %}
		</div>
		
		<div id="footer">
			<span class="key_item"><img src="/furniture/price_increase_arrow.png" width="10" height="12" alt="Price increase" /> Price increase</span> <span class="key_item"><img src="/furniture/price_decrease_arrow.png" width="10" height="12" alt="Price decrease" /> Price decrease</span> <span class="key_item"><img src="/furniture/new_product_star.png" width="11" height="12" alt="New product" /> New product / brand / size</span>
		</div>
		
{% endblock %}

{% block side %}
	<div id="cart_content">
		{% include "cart.html" %}		
		<script type="text/javascript" charset="utf-8">
			Event.observe(window, 'load', function(event){var cart = new FNCart();});
		</script>
	</div>
	
	{% block review %}
		<form id="continue_form" action="/cart/review/" method="get"><input type="submit" value="Prepare for submission" id="continue_button" /></form>
	{% endblock %}
{% endblock %}